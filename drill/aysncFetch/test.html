<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body></body>
  <script src="./index.js"></script>
  <script>
    //test1
    /*
    function getData(data) {
      return new Promise(function (resolve, reject) {
        console.log('请求开始');
        setTimeout(() => {
            data = data || 'request error';
            resolve(data);
        }, 4000*Math.random()+1);
      });
    }
    getData(1)
    .then(data=> {
        if (data !== 'request error') {
            console.log(data);
            return getData(2)
        }
    })
    .then(data=> {
        if (data !== 'request error') {
            console.log(data);
            return getData(3)
        }
    })
    .then(data=> {
        console.log(data);
    })
    //*/

    //test2
    
    // class taskManage {  
    //     sum = 0;
    //     max = 10;
    //     total = 0;
    //     doing = 0;
    //     constructor(total, max = 10) {
    //         this.total = total;
    //         this.max = max;
    //         this.start()
    //     }

    //     task() {
    //         return new Promise( (resolve, reject)=> {
    //             let {sum} = this;
    //             let time;
    //             if(sum === 10){
    //                 time = 5000
    //             }else {
    //                 time = 3000 * Math.random() + 1000
    //             }
    //             console.log(`task ${sum}start`);
    //             setTimeout(() => {
    //                 console.log(`task ${sum}done`);
    //                 resolve();
    //             }, time);
    //         });
    //     }

    //     work() {
    //         if (this.total > this.sum && this.max > this.doing) {
    //             this.doing++;
    //             this.sum++;
    //             if (this.sum > this.max) { console.log('进程空闲即将开始处理...');}
    //             this.task().then(()=> {
    //                 this.doing--;
    //                 this.work();
    //             })
    //             if (this.max === this.doing) { console.log('进程数以达到上线');}
    //         }
    //     }

    //     start() {
    //         for (let i = 0; i < this.max; i++) {
    //             this.work();
    //         }
    //     }
    // }
    // let tm = new taskManage(10,2);

    // //test3
    // function curry(fn, ...arg) {
    //   return (...rest) => {
    //     let newArg = [...arg, ...rest];
    //     if (rest.length === 0) return fn.apply(null, newArg);
    //     return curry(fn, ...newArg);
    //   };
    // }
    
    // function sum(...rest) {
    //   return rest.reduce((a, b) => a + b, 0);
    // }
    
    // let add = curry(sum);
    // add(1)(2)(3,4)()
    
    
  </script>
</html>
